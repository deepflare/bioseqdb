CREATE EXTENSION mmseq2;

CREATE TABLE query(
    id bigint,
    seq aa_seq
);

CREATE TABLE target(
    id bigint,
    seq aa_seq
);

INSERT INTO query VALUES (1, 'MKFKLKTTSGTARRGEMTFSRPQGEFTVQTPAFMPVGTYGTVKGMTPEEVRATGAEILLGNTFHLWLRPGQEVMRKHGDLHDFMQWHRPILTDSGGFQVFSLGKLRKITEEGVKFQNPINGERIFLSPEKSMEIQYDLGSDIVMIFDECTPYPATFDYAKKSMEMSLRWAQRSRDRFDELGNKNALFGIVQGGTFEELRKVSAEGLVDIGFDGYAVGGLAVGEPKEEMHRILEFTTPLLPADKPRYLMGVGKPEDLVEGVRRGIDMFDCVMPTRNARNGHLFVTDGIVKIRNAKYRDDTSALDPHCDCYTCRHYTKSYLYHLDKCGEILGARLNTIHNLRYYQRLMEEIRQAIEEDRFDDFVVEFYTRMGKEVPPLQKP');

INSERT INTO target VALUES (11, 'MKFELDTTDGRARRGRLIFERGTVETPAFMPVGTYGTVKGMTPEEVRATGADILLGNTFHLWLRPGEEIMRKHGDLHDFMNWQRPILTDSGGFQVFSLGDIRKITEEGVHFRSPINGEKIFLDPEKSMQIQHALGSDVVMIFDECTPYPATEDEARKSMQMSLRWAKRSRDEFDRLENPNSLFGIIQGSVYEDLRDESLKGLVEIGFDGYAVGGLAVGEPKEDMHRILEHVCPQIPADKPRYLMGVGKPEDLVEGVRRGIDMFDCVMPTRNARNGHLFTSEGVIKIRNARHRDDTSPLDPKCDCYTCKNYSRAYLYHLDRCNEILGARLNTIHNLRYYQMLMEGLRGAIETGTLDAFVKDFYTSQGREVPELVD');
INSERT INTO target VALUES (12, 'MYKLLKKSGKARRGEFTTPHGVIQTPVFMNVGTLAAIKGAVSSMDLKEIGCQVELSNTYHLHLRPGDEVVKKMGGLHKFMNWDRPILTDSGGFQVFSLSKIRKIQEEGVYFNSHIDGRKIFMGPEESMRIQSNLASTIAMAFDECVENPAPREYVEKSVERTTRWLHRCKDEMNRLNSLPDTINNKQMLFGINQGGTYEDIRIEHAKTIAKMDLDGYAIGGLAVGESHEDMYRIIDAVVPHLPEDKPIYLMGVGIPSNILEAVDRGVDFFDCVLPARNGRHAHVFTKEGKINLLNAKFELDDRPIDEGCQCPACKHYTRSYIRHLFKAKEMLAMRLCVLHNLYFYNNLMEEIRDAIDGDYFKEYKERKLKEWGGRA');
INSERT INTO target VALUES (12, 'MYKLLKKSGKARRGEFTTPHGVIQTPVFMNVGTLAAIKGAVSSMDLKEIGCQVELSNTYHLHLRPGDEVVKKMGGLHKFMNWDRPILTDSGGFQVFSLSKIRKIQEEGVYFNSHIDGRKIFMGPEESMRIQSNLASTIAMAFDECVENPAPREYVEKSVERTTRWLHRCKDEMNRLNSLPDTINNKQMLFGINQGGTYEDIRIEHAKTIAKMDLDGYAIGGLAVGESHEDMYRIIDAVVPHLPEDKPIYLMGVGIPSNILEAVDRGVDFFDCVLPARNGRHAHVFTKEGKINLLNAKFELDDRPIDEGCQCPACKHYTRSYIRHLFKAKEMLAMRLCVLHNLYFYNNLMEEIRDAIDGDYFKEYKERKLKEWGGRA');

SELECT * FROM aa_search_db_to_db('query', 'seq', 'target', 'seq', kmer_gen_threshold => 17);
